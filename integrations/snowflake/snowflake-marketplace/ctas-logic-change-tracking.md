# CTAS logic change tracking

{% embed url="https://youtu.be/l36dOAFYASg" %}

DWH.dev tracks logical changes in `CREATE TABLE AS SELECT` (CTAS) operations based on data from Snowflake’s `QUERY_HISTORY`.\
For every CTAS statement, the corresponding target object is identified, and its `query_hash` — the unique identifier of the compiled query generated by Snowflake — is extracted.

If the current `query_hash` differs from the previously stored one, DWH.dev flags this as a **CTAS logic change** and automatically recalculates all dependent lineage relationships.\
This means that even when the table name remains unchanged, any modification in the SQL logic (such as added columns, altered joins, filters, or expressions) is immediately reflected in the lineage graph.

#### Used for

* Tracking the evolution of transformation logic over time.
* Auditing business-logic changes without manually comparing SQL code.
* Automatically updating lineage whenever CTAS logic changes.
* Preventing silent downstream inconsistencies caused by logic drift.
